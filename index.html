<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ライフゲーム（複数パターン）</title>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      background: #f0f0f0;
    }
    canvas {
      border: 1px solid #555;
      touch-action: none;
    }
    button, select {
      font-size: 18px;
      margin: 10px;
      padding: 10px 20px;
    }
  </style>
</head>
<body>
  <h1>ライフゲーム（タブレット対応）</h1>
  <canvas id="game" width="400" height="400"></canvas><br />
  <button id="startBtn">スタート</button>
  <button id="clearBtn">クリア</button>
  <select id="patternSelect">
    <option value="Alpha">Face</option>
    <option value="Bravo">Pig</option>
    <option value="Charlie">Shark</option>
    <option value="Delta">Elephant</option>
    <option value="Echo">Whale</option>
    <option value="Fox">Panda</option>
    <option value="Golf">Nyibrary</option>
    <option value="Hotel">Toad</option>
    <option value="India">Ghost</option>
    <option value="Juliett">Mario</option>
    <option value="Kilo">Star</option>
    <option value="Lima">Kuchipatchi</option>
  </select>
  <button id="patternBtn">パターン表示</button>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const rows = 40;
    const cols = 40;
    const cellSize = canvas.width / cols;
    let grid = Array.from({ length: rows }, () => Array(cols).fill(0));
    let running = false;
    let interval;

    const patterns = {
      Alpha: {
        offsetX: 12,
        offsetY: 12,
        cells: [
          [3, 0],[4, 0],[5, 0],[6, 0],[7, 0],[8, 0],[9, 0],[10, 0],[11, 0],[12, 0],
          [2, 1],[3, 1],[3, 1],[12, 1],[13, 1],
          [1, 2],[2, 2],[13, 2],[14, 2],
          [0, 3],[1, 3],[3, 3],[4, 3],[5, 3],[10, 3],[11, 3],[12, 3],[14, 3],[15, 3],
          [0, 4],[2, 4],[6, 4],[9, 4],[13, 4],[15, 4],
          [0, 5],[4, 5],[11, 5],[15, 5],
          [0, 6],[3, 6],[4, 6],[5, 6],[10, 6],[11, 6],[12, 6],[15, 6],
          [0, 7],[2, 7],[4, 7],[6, 7],[9, 7],[11, 7],[13, 7],[15, 7],
          [0, 8],[7, 8],[8, 8],[15, 8],
          [0, 9],[7, 9],[8, 9],[15, 9],
          [0, 10],[4, 10],[7, 10],[8, 10],[11, 10],[15, 10],
          [0, 11],[1, 11],[3, 11],[4, 11],[11, 11],[12, 11],[14, 11],[15, 11],
          [1, 12],[2, 12],[5, 12],[7, 12],[8, 12],[10, 12],[13, 12],[14, 12],
          [2, 13],[3, 13],[6, 13],[9, 13],[12, 13],[13, 13],
          [3, 14],[4, 14],[11, 14],[12, 14],
          [4, 15],[5, 15],[6, 15],[7, 15],[8, 15],[9, 15],[10, 15],[11, 15]
]
      },
      Bravo: {
        offsetX: 10,
        offsetY: 10,
        cells: [
          [0, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0], [9, 0], [10, 0], [14, 0], [15, 0], [16, 0], [17, 0], [18, 0], [19, 0],
          [0, 1], [4, 1], [10, 1], [14, 1], [15, 1], [16, 1], [17, 1], [18, 1], [19, 1],
          [0, 2], [1, 2], [4, 2], [10, 2], [13, 2], [14, 2], [15, 2], [16, 2], [17, 2], [19, 2],
          [0, 3], [1, 3], [2, 3], [3, 3], [4, 3], [10, 3], [11, 3], [12, 3], [13, 3], [16, 3], [17, 3], [18, 3],
          [0, 4], [14, 4], [18, 4],
          [4, 5], [9, 5], [15, 5], [19, 5],
          [15, 6],
          [3, 7], [4, 7], [5, 7], [6, 7], [7, 7], [8, 7], [9, 7], [10, 7], [15, 7],
          [2, 8], [11, 8], [15, 8],
          [2, 9], [11, 9], [15, 9],
          [2, 10], [5, 10], [8, 10], [11, 10], [15, 10],
          [2, 11], [5, 11], [8, 11], [11, 11], [15, 11],
          [0, 12], [2, 12], [3, 12], [10, 12], [11, 12], [14, 12], [15, 12],
          [0, 13], [1, 13], [3, 13], [4, 13], [5, 13], [6, 13], [7, 13], [8, 13], [9, 13], [10, 13], [13, 13], [14, 13],
          [0, 14], [1, 14], [2, 14], [11, 14], [12, 14], [13, 14],
          [0, 15], [1, 15], [2, 15], [3, 15], [4, 15], [5, 15], [6, 15], [7, 15], [8, 15], [9, 15], [10, 15], [11, 15],
          [0, 16], [1, 16], [2, 16],
          [0, 17], [1, 17], [2, 17], [19, 17],
          [0, 18], [1, 18], [2, 18], [6, 18], [7, 18], [8, 18], [12, 18], [15, 18], [16, 18], [19, 18],
          [0, 19], [1, 19], [2, 19], [6, 19], [7, 19], [8, 19], [12, 19], [15, 19], [16, 19], [19, 19]
        ]
      },
      Charlie: {
        offsetX: 10,
        offsetY: 10,
        cells: [
          [3, 0], [11, 0], [12, 0], [13, 0], [14, 0], [15, 0], [16, 0], [17, 0],
          [3, 1], [11, 1], [12, 1], [18, 1],
          [2, 2], [3, 2], [10, 2], [11, 2], [13, 2], [17, 2], [19, 2],
          [1, 3], [2, 3], [3, 3], [9, 3], [10, 3], [11, 3], [19, 3],
          [0, 4], [1, 4], [2, 4], [3, 4], [9, 4], [11, 4], [14, 4], [15, 4], [16, 4], [17, 4], [18, 4], [19, 4],
          [1, 5], [2, 5], [8, 5], [9, 5], [10, 5], [13, 5], [15, 5], [17, 5], [19, 5],
          [1, 6], [2, 6], [8, 6], [9, 6], [10, 6], [12, 6], [13, 6], [14, 6], [15, 6], [16, 6], [17, 6], [18, 6], [19, 6],
          [1, 7], [2, 7], [4, 7], [5, 7], [6, 7], [7, 7], [8, 7], [9, 7], [12, 7], [14, 7], [15, 7], [16, 7], [17, 7], [19, 7],
          [1, 8], [2, 8], [5, 8], [6, 8], [7, 8], [8, 8], [9, 8], [11, 8], [12, 8], [13, 8], [14, 8], [15, 8], [16, 8], [17, 8], [18, 8], [19, 8],
          [1, 9], [2, 9], [3, 9], [6, 9], [7, 9], [8, 9], [9, 9], [11, 9], [13, 9], [14, 9], [15, 9], [16, 9], [17, 9], [19, 9],
          [1, 10], [2, 10], [3, 10], [4, 10], [5, 10], [6, 10], [7, 10], [8, 10], [10, 10], [11, 10], [12, 10], [13, 10], [14, 10], [15, 10], [16, 10], [17, 10], [18, 10], [19, 10],
          [1, 11], [2, 11], [3, 11], [4, 11], [5, 11], [6, 11], [7, 11], [8, 11], [10, 11], [12, 11], [13, 11], [14, 11], [15, 11], [16, 11], [17, 11], [19, 11],
          [1, 12], [2, 12], [3, 12], [4, 12], [5, 12], [6, 12], [7, 12], [8, 12], [10, 12], [11, 12], [12, 12], [13, 12], [14, 12], [15, 12], [16, 12], [17, 12], [18, 12], [19, 12],
          [1, 13], [2, 13], [3, 13], [4, 13], [5, 13], [6, 13], [7, 13], [8, 13], [10, 13], [12, 13], [14, 13], [16, 13], [18, 13], [19, 13],
          [2, 14], [3, 14], [4, 14], [5, 14], [6, 14], [7, 14], [10, 14], [11, 14], [12, 14], [13, 14], [14, 14], [15, 14], [16, 14], [17, 14], [18, 14], [19, 14],
          [2, 15], [3, 15], [4, 15], [5, 15], [6, 15], [7, 15], [19, 15],
          [3, 16], [4, 16], [5, 16], [6, 16], [7, 16], [18, 16], [19, 16],
          [2, 17], [3, 17], [4, 17], [5, 17], [6, 17], [16, 17], [17, 17], [18, 17],
          [1, 18], [2, 18], [3, 18], [4, 18], [5, 18], [6, 18], [7, 18], [8, 18], [9, 18], [10, 18], [11, 18], [12, 18], [13, 18], [14, 18], [15, 18], [16, 18], [17, 18],
          [0, 19], [1, 19], [2, 19], [3, 19], [4, 19], [15, 19], [16, 19], [17, 19], [18, 19]
       ]
      },
      Delta: {
        offsetX: 10,
        offsetY: 10,
        cells: [
          [1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [10, 0], [11, 0], [12, 0], [13, 0], [14, 0], [15, 0], [16, 0], [17, 0], [18, 0], [19, 0],
          [0, 1], [6, 1], [11, 1], [17, 1], [18, 1], [19, 1],
          [11, 2], [12, 2], [19, 2],
          [12, 3],
          [12, 4],
          [12, 5],
          [6, 6], [12, 6],
          [4, 7], [6, 7], [11, 7], [12, 7],
          [6, 8], [6, 10], [6, 11],
          [6, 9], [7, 9], [8, 9], [9, 9], [10, 9],
          [0, 10], [4, 10], [5, 10], [6, 10],
          [0, 11], [3, 11], [4, 11], [14, 11],
          [0, 12], [3, 12], [14, 12],
          [0, 13], [3, 13], [6, 13], [10, 13], [13, 13], [14, 13],
          [0, 14], [3, 14], [5, 14], [6, 14], [10, 14], [11, 14], [12, 14], [13, 14], [14, 14], [15, 14], [19, 14],
          [0, 15], [3, 15], [4, 15], [5, 15], [10, 15], [11, 15], [12, 15], [15, 15], [16, 15], [19, 15],
          [0, 16], [1, 16], [4, 16], [9, 16], [10, 16], [11, 16], [12, 16], [15, 16], [16, 16], [19, 16],
          [0, 17], [1, 17], [2, 17], [3, 17], [4, 17], [8, 17], [9, 17], [11, 17], [12, 17], [15, 17], [16, 17], [19, 17],
          [0, 18], [1, 18], [2, 18], [3, 18], [4, 18], [8, 18], [11, 18], [12, 18], [15, 18], [16, 18], [19, 18],
          [0, 19], [1, 19], [2, 19], [3, 19], [4, 19], [8, 19], [9, 19], [10, 19], [11, 19], [12, 19], [13, 19], [14, 19], [15, 19], [16, 19], [17, 19], [18, 19], [19, 19]
        ]
      },
      Echo: {
        offsetX: 10,
        offsetY: 10,
        cells: [
          [3, 0], [4, 0], [5, 0], [7, 0], [8, 0], [9, 0], [12, 0], [13, 0], [18, 0], [19, 0],
          [2, 1], [6, 1], [10, 1], [12, 1], [13, 1], [14, 1], [18, 1], [19, 1],
          [2, 2], [6, 2], [10, 2], [12, 2], [13, 2], [14, 2], [15, 2], [17, 2], [18, 2], [19, 2],
          [2, 3], [6, 3], [10, 3], [12, 3], [13, 3], [14, 3], [15, 3], [16, 3], [17, 3], [18, 3], [19, 3],
          [13, 4], [14, 4], [15, 4], [16, 4], [17, 4], [18, 4], [19, 4],
          [3, 5], [4, 5], [5, 5], [6, 5], [7, 5], [8, 5], [15, 5], [16, 5], [17, 5], [18, 5],
          [1, 6], [2, 6], [3, 6], [4, 6], [5, 6], [6, 6], [7, 6], [8, 6], [9, 6], [10, 6], [16, 6], [17, 6],
          [0, 7], [1, 7], [2, 7], [3, 7], [4, 7], [5, 7], [6, 7], [7, 7], [8, 7], [9, 7], [10, 7], [11, 7], [16, 7], [17, 7],
          [0, 8], [1, 8], [2, 8], [3, 8], [4, 8], [5, 8], [6, 8], [7, 8], [8, 8], [9, 8], [10, 8], [11, 8], [16, 8], [17, 8], [18, 8],
          [0, 9], [1, 9], [2, 9], [3, 9], [4, 9], [5, 9], [6, 9], [7, 9], [9, 9], [10, 9], [11, 9], [12, 9], [16, 9], [17, 9], [18, 9],
          [5, 10], [6, 10], [7, 10], [8, 10], [9, 10], [10, 10], [11, 10], [12, 10], [13, 10], [16, 10], [17, 10], [18, 10],
          [0, 11], [1, 11], [2, 11], [3, 11], [6, 11], [7, 11], [8, 11], [9, 11], [10, 11], [11, 11], [12, 11], [13, 11], [14, 11], [15, 11], [16, 11], [17, 11], [18, 11],
          [0, 12], [4, 12], [7, 12], [8, 12], [9, 12], [10, 12], [11, 12], [12, 12], [13, 12], [14, 12], [15, 12], [16, 12], [17, 12], [18, 12],
          [0, 13], [5, 13], [9, 13], [10, 13], [11, 13], [12, 13], [13, 13], [14, 13], [15, 13], [16, 13], [17, 13], [18, 13],
          [0, 14], [5, 14], [6, 14], [7, 14], [8, 14], [9, 14], [10, 14], [11, 14], [12, 14], [13, 14], [14, 14], [15, 14], [16, 14], [17, 14], [18, 14],
          [1, 15], [2, 15], [9, 15], [10, 15], [11, 15], [12, 15], [13, 15], [14, 15], [15, 15], [16, 15], [17, 15], [18, 15],
          [3, 16], [9, 16], [10, 16], [11, 16], [12, 16], [13, 16], [14, 16], [15, 16], [16, 16], [17, 16],
          [4, 17], [5, 17], [6, 17], [7, 17], [8, 17], [9, 17], [10, 17], [11, 17], [12, 17], [13, 17], [14, 17], [15, 17], [16, 17],
          [3, 18], [4, 18], [5, 18], [10, 18], [11, 18], [12, 18], [13, 18],
          [2, 19], [3, 19], [4, 19], [11, 19], [12, 19], [13, 19], [14, 19]
        ]
      },
      Fox: {
        offsetX: 10,
        offsetY: 10,
        cells: [
          [8, 0], [9, 0], [10, 0], [17, 0], [18, 0],
          [7, 1], [8, 1], [9, 1], [10, 1], [16, 1], [17, 1], [18, 1], [19, 1],
          [7, 2], [8, 2], [9, 2], [17, 2], [18, 2], [19, 2],
          [3, 3], [7, 3], [18, 3],
          [2, 4], [6, 4],
          [1, 5], [5, 5], [6, 5],
          [0, 6], [1, 6], [5, 6], [19, 6],
          [0, 7], [1, 7], [4, 7], [5, 7], [9, 7], [10, 7], [19, 7],
          [0, 8], [1, 8], [4, 8], [5, 8], [8, 8], [9, 8], [10, 8], [14, 8], [15, 8], [19, 8],
          [0, 9], [1, 9], [4, 9], [5, 9], [6, 9], [8, 9], [9, 9], [14, 9], [15, 9], [16, 9], [19, 9],
          [0, 10], [1, 10], [4, 10], [5, 10], [6, 10], [15, 10], [16, 10], [19, 10],
          [0, 11], [1, 11], [4, 11], [5, 11], [6, 11], [7, 11], [11, 11], [12, 11], [13, 11], [18, 11], [19, 11],
          [0, 12], [1, 12], [2, 12], [4, 12], [5, 12], [6, 12], [7, 12], [8, 12], [9, 12], [12, 12], [16, 12], [17, 12], [18, 12], [19, 12],
          [0, 13], [1, 13], [2, 13], [3, 13], [5, 13], [6, 13], [7, 13], [8, 13], [9, 13], [10, 13], [11, 13], [13, 13], [14, 13], [15, 13], [16, 13], [17, 13], [18, 13],
          [0, 14], [1, 14], [2, 14], [3, 14], [4, 14], [5, 14], [6, 14], [7, 14], [8, 14], [9, 14], [10, 14], [11, 14], [12, 14], [13, 14], [14, 14], [15, 14], [16, 14], [17, 14], [18, 14],
          [1, 15], [2, 15], [3, 15], [4, 15], [5, 15], [6, 15], [7, 15], [8, 15], [9, 15], [10, 15], [11, 15], [12, 15], [13, 15], [14, 15], [15, 15], [16, 15], [17, 15],
          [1, 16], [2, 16], [3, 16], [4, 16], [6, 16], [7, 16], [8, 16], [9, 16], [10, 16], [11, 16], [14, 16], [15, 16], [16, 16], [17, 16],
          [2, 17], [3, 17], [4, 17], [6, 17], [7, 17], [8, 17], [9, 17], [10, 17], [11, 17], [14, 17], [15, 17], [16, 17], [17, 17],
          [3, 18], [4, 18], [7, 18], [8, 18], [9, 18], [10, 18], [11, 18], [12, 18], [14, 18], [15, 18], [16, 18],
          [8, 19], [9, 19], [10, 19], [11, 19], [12, 19], [14, 19], [15, 19]
        ]
      },
      Golf: {
        offsetX: 11,
        offsetY: 11,
        cells: [
          [2, 0], [16, 0],
          [1, 1], [2, 1], [3, 1], [15, 1], [16, 1], [17, 1],
          [1, 2], [2, 2], [3, 2], [4, 2], [14, 2], [15, 2], [16, 2], [17, 2],
          [0, 3], [1, 3], [2, 3], [3, 3], [4, 3], [5, 3], [13, 3], [14, 3], [15, 3], [16, 3], [17, 3], [18, 3],
          [0, 4], [1, 4], [2, 4], [3, 4], [4, 4], [5, 4], [6, 4], [12, 4], [13, 4], [14, 4], [15, 4], [16, 4], [17, 4], [18, 4],
          [6, 7], [12, 7],
          [0, 9], [1, 9], [2, 9], [3, 9], [15, 9], [16, 9], [17, 9], [18, 9],
          [5, 10], [13, 10],
          [0, 11], [1, 11], [2, 11], [3, 11], [5, 11], [6, 11], [12, 11], [13, 11], [15, 11], [16, 11], [17, 11], [18, 11],
          [6, 12], [7, 12], [8, 12], [9, 12], [10, 12], [11, 12], [12, 12],
          [6, 14], [12, 14],
          [5, 15], [6, 15], [7, 15], [11, 15], [12, 15], [13, 15],
          [5, 16], [6, 16], [7, 16], [8, 16], [9, 16], [10, 16], [11, 16], [12, 16], [13, 16],
          [5, 17], [6, 17], [7, 17], [8, 17], [10, 17], [11, 17], [12, 17], [13, 17],
          [6, 18], [12, 18]
        ]
      },
      Hotel: {
        offsetX: 12,
        offsetY: 13,
        cells: [
          [6, 0], [7, 0], [8, 0], [9, 0],
          [4, 1], [5, 1], [6, 1], [7, 1], [8, 1], [9, 1], [10, 1], [11, 1],
          [3, 2], [4, 2], [5, 2], [10, 2], [11, 2], [12, 2],
          [2, 3], [3, 3], [4, 3], [11, 3], [12, 3], [13, 3],
          [1, 4], [3, 4], [4, 4], [11, 4], [12, 4], [14, 4],
          [1, 5], [3, 5], [4, 5], [11, 5], [12, 5], [14, 5],
          [0, 6], [3, 6], [4, 6], [5, 6], [10, 6], [11, 6], [12, 6], [15, 6],
          [0, 7], [2, 7], [3, 7], [4, 7], [5, 7], [6, 7], [7, 7], [8, 7], [9, 7], [10, 7], [11, 7], [12, 7], [13, 7], [15, 7],
          [0, 8], [1, 8], [2, 8], [3, 8], [4, 8], [6, 8], [9, 8], [11, 8], [12, 8], [13, 8], [14, 8], [15, 8],
          [1, 9], [2, 9], [3, 9], [6, 9], [9, 9], [12, 9], [13, 9], [14, 9],
          [2, 10], [3, 10], [6, 10], [9, 10], [12, 10], [13, 10],
          [3, 11], [12, 11],
          [4, 12], [11, 12],
          [5, 13], [6, 13], [7, 13], [8, 13], [9, 13], [10, 13]
        ]
      },
      India: {
        offsetX: 10,
        offsetY: 10,
        cells: [
          [0, 0], [1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0], [9, 0], [10, 0], [11, 0], [12, 0], [13, 0], [14, 0], [15, 0], [16, 0], [17, 0], [18, 0], [19, 0],
          [0, 1], [3, 1], [5, 1], [16, 1], [17, 1], [18, 1], [19, 1],
          [0, 2], [3, 2], [5, 2], [17, 2], [18, 2], [19, 2],
          [0, 3], [4, 3], [18, 3], [19, 3],
          [0, 4], [7, 4], [8, 4], [9, 4], [10, 4], [11, 4], [19, 4],
          [0, 5], [5, 5], [6, 5], [11, 5], [12, 5], [19, 5],
          [0, 6], [4, 6], [5, 6], [13, 6], [19, 6],
          [0, 7], [4, 7], [6, 7], [7, 7], [9, 7], [10, 7], [13, 7], [19, 7],
          [0, 8], [3, 8], [4, 8], [13, 8], [19, 8],
          [0, 9], [3, 9], [13, 9], [19, 9],
          [0, 10], [3, 10], [7, 10], [8, 10], [9, 10], [13, 10], [17, 10], [19, 10],
          [0, 11], [3, 11], [8, 11], [14, 11], [16, 11], [17, 11], [19, 11],
          [0, 12], [3, 12], [14, 12], [15, 12], [17, 12], [19, 12],
          [0, 13], [4, 13], [6, 13], [8, 13], [10, 13], [12, 13], [17, 13], [19, 13],
          [0, 14], [5, 14], [7, 14], [11, 14], [16, 14], [19, 14],
          [0, 15], [6, 15], [16, 15], [19, 15],
          [0, 16], [7, 16], [8, 16], [9, 16], [10, 16], [11, 16], [12, 16], [13, 16], [14, 16], [15, 16], [19, 16],
          [0, 17], [1, 17], [19, 17],
          [0, 18], [1, 18], [2, 18], [19, 18],
          [0, 19], [1, 19], [2, 19], [3, 19], [4, 19], [5, 19], [6, 19], [7, 19], [8, 19], [9, 19], [10, 19], [11, 19], [12, 19], [13, 19], [14, 19], [15, 19], [16, 19], [17, 19], [18, 19], [19, 19]
        ]
      },
      Juliett: {
        offsetX: 11,
        offsetY: 10,
        cells: [
          [14, 2], [15, 2], [16, 2], [17, 2],
          [13, 3], [17, 3],
          [7, 4], [8, 4], [9, 4], [10, 4], [11, 4], [13, 4], [17, 4],
          [6, 5], [7, 5], [8, 5], [9, 5], [10, 5], [11, 5], [12, 5], [13, 5], [17, 5],
          [6, 6], [7, 6], [8, 6], [11, 6], [14, 6], [15, 6], [16, 6], [17, 6],
          [5, 7], [7, 7], [11, 7], [14, 7], [15, 7], [16, 7], [17, 7],
          [5, 8], [7, 8], [8, 8], [12, 8], [16, 8], [17, 8],
          [5, 9], [6, 9], [11, 9], [12, 9], [13, 9], [14, 9], [15, 9], [16, 9],
          [6, 10], [14, 10], [15, 10],
          [2, 11], [3, 11], [4, 11], [5, 11], [6, 11], [7, 11], [9, 11], [10, 11], [11, 11], [13, 11], [14, 11], [16, 11], [17, 11],
          [1, 12], [2, 12], [3, 12], [4, 12], [5, 12], [6, 12], [7, 12], [8, 12], [10, 12], [11, 12], [12, 12], [14, 12], [16, 12], [17, 12],
          [0, 13], [3, 13], [4, 13], [5, 13], [6, 13], [7, 13], [8, 13], [14, 13], [15, 13], [16, 13], [17, 13],
          [0, 14], [4, 14], [7, 14], [10, 14], [13, 14], [15, 14], [16, 14], [17, 14],
          [1, 15], [3, 15], [15, 15], [16, 15], [17, 15],
          [2, 16], [4, 16], [15, 16], [16, 16], [17, 16],
          [2, 17], [3, 17], [4, 17], [5, 17], [12, 17], [13, 17], [14, 17], [15, 17], [16, 17], [17, 17],
          [1, 18], [2, 18], [3, 18], [4, 18], [9, 18], [10, 18], [11, 18],
          [1, 19], [2, 19], [3, 19], [5, 19], [6, 19], [7, 19], [8, 19]
        ]
      },
      Kilo: {
        offsetX: 11,
        offsetY: 11,
        cells: [
          [9, 0],
          [8, 1], [10, 1],
          [8, 2], [10, 2],
          [8, 3], [10, 3],
          [7, 4], [11, 4],
          [7, 5], [11, 5],
          [7, 6], [11, 6],
          [0, 7], [1, 7], [2, 7], [3, 7], [4, 7], [5, 7], [6, 7], [7, 7], [11, 7], [12, 7], [13, 7], [14, 7], [15, 7], [16, 7], [17, 7], [18, 7],
          [0, 8], [18, 8],
          [1, 9], [17, 9],
          [1, 10], [7, 10], [11, 10], [17, 10],
          [2, 11], [7, 11], [11, 11], [16, 11],
          [3, 12], [15, 12],
          [3, 13], [15, 13],
          [3, 14], [15, 14],
          [3, 15], [9, 15], [15, 15],
          [2, 16], [6, 16], [7, 16], [8, 16], [10, 16], [11, 16], [12, 16], [16, 16],
          [1, 17], [4, 17], [5, 17], [13, 17], [14, 17], [17, 17],
          [1, 18], [2, 18], [3, 18], [15, 18], [16, 18], [17, 18]
        ]
      },
      Lima: {
        offsetX: 10,
        offsetY: 10,
        cells: [
          [6, 0], [7, 0], [8, 0], [9, 0], [10, 0], [11, 0], [12, 0], [13, 0], [14, 0],
          [5, 1], [15, 1],
          [4, 2], [5, 2], [16, 2],
          [1, 3], [2, 3], [3, 3], [7, 3], [13, 3], [17, 3],
          [0, 4], [17, 4],
          [1, 5], [2, 5], [3, 5], [17, 5],
          [0, 6], [17, 6],
          [1, 7], [2, 7], [3, 7], [18, 7],
          [4, 8], [12, 8], [14, 8], [19, 8],
          [4, 9], [12, 9], [14, 9], [19, 9],
          [4, 10], [13, 10], [19, 10],
          [4, 11], [19, 11],
          [4, 12], [19, 12],
          [4, 13], [18, 13],
          [4, 14], [17, 14],
          [5, 15], [9, 15], [10, 15], [11, 15], [12, 15], [16, 15],
          [6, 16], [9, 16], [12, 16], [15, 16],
          [6, 17], [9, 17], [12, 17], [15, 17],
          [7, 18], [8, 18], [13, 18], [14, 18],
          [7, 19], [8, 19], [13, 19], [14, 19]
        ]
      },
    };

    function drawGrid() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let y = 0; y < rows; y++) {
        for (let x = 0; x < cols; x++) {
          ctx.fillStyle = grid[y][x] ? '#000' : '#fff';
          ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
          ctx.strokeStyle = '#ccc';
          ctx.strokeRect(x * cellSize, y * cellSize, cellSize, cellSize);
        }
      }
    }

    function updateGrid() {
      const newGrid = grid.map(arr => arr.slice());
      for (let y = 1; y < rows - 1; y++) {
        for (let x = 1; x < cols - 1; x++) {
          let count = 0;
          for (let dy = -1; dy <= 1; dy++) {
            for (let dx = -1; dx <= 1; dx++) {
              if (dx !== 0 || dy !== 0) {
                count += grid[y + dy][x + dx];
              }
            }
          }
          if (grid[y][x] === 1) {
            newGrid[y][x] = (count === 2 || count === 3) ? 1 : 0;
          } else {
            newGrid[y][x] = (count === 3) ? 1 : 0;
          }
        }
      }
      grid = newGrid;
      drawGrid();
    }

    function toggleCell(x, y) {
      const col = Math.floor(x / cellSize);
      const row = Math.floor(y / cellSize);
      if (col >= 0 && col < cols && row >= 0 && row < rows) {
        grid[row][col] = 1 - grid[row][col];
        drawGrid();
      }
    }

    function loadPattern(name) {
      if (!patterns[name]) return;
      grid = Array.from({ length: rows }, () => Array(cols).fill(0));
      const { offsetX, offsetY, cells } = patterns[name];
      for (const [x, y] of cells) {
        const gx = offsetX + x;
        const gy = offsetY + y;
        if (gx >= 0 && gx < cols && gy >= 0 && gy < rows) {
          grid[gy][gx] = 1;
        }
      }
      drawGrid();
    }

    canvas.addEventListener('mousedown', e => {
      const rect = canvas.getBoundingClientRect();
      toggleCell(e.clientX - rect.left, e.clientY - rect.top);
    });

    canvas.addEventListener('touchstart', e => {
      const rect = canvas.getBoundingClientRect();
      const touch = e.touches[0];
      toggleCell(touch.clientX - rect.left, touch.clientY - rect.top);
      e.preventDefault();
    }, { passive: false });

    document.getElementById('startBtn').addEventListener('click', () => {
      running = !running;
      document.getElementById('startBtn').textContent = running ? 'ストップ' : 'スタート';
      if (running) {
        interval = setInterval(updateGrid, 200);
      } else {
        clearInterval(interval);
      }
    });

    document.getElementById('clearBtn').addEventListener('click', () => {
      grid = Array.from({ length: rows }, () => Array(cols).fill(0));
      drawGrid();
    });

    document.getElementById('patternBtn').addEventListener('click', () => {
      const selected = document.getElementById('patternSelect').value;
      loadPattern(selected);
    });

    drawGrid();
  </script>
</body>
</html>
